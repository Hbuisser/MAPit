<div class=courses-page>

  <div class="courses-container">
    <h1 class="highlight">My courses</h1>
    <% if current_user != nil %>
      <% @my_courses.each do |course| %>
        <% if !@my_courses.present? %>
        <p>No courses yet!</p>
        <% end %>
        <div class="popup">

          <div class="card-trip"
            data-toggle="popover"
            data-placement="right"
            title="<b><%= course.name.capitalize %></b>"
            data-content='<%=
              (link_to "Continue course", course_subscription_path(course.id, Subscription.all.where(user: current_user).where(course: course).first.id)) %>' >
            <img src="https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/greece.jpg">
            <div class="card-trip-infos">
              <h2><%= course.name.capitalize %></h2>
            </div>

          <!-- <div class="card-trip">
            <span class="popuptext myPopup">
              <img src="<%= course.picture %>">

              <div class="card-trip-infos">
                <h2><%= course.name.capitalize %></h2>
              </div>
              <button name="button" type="submit" class="button">
                <%= link_to "Continue course", course_subscription_path(course.id, Subscription.all.where(user: current_user).where(course: course).first.id)%>
              </button>

              <button name="button" type="submit" class="button">
                <%= link_to "delete course", course_subscription_path(course.id, Subscription.all.where(user: current_user).where(course: course).first.id), method: :delete%>
              </button>

            </span>
           <img src="<%= course.picture %>">
            <div class="card-trip-infos">
              <h2><%= course.name.capitalize %></h2>
            </div> -->
            <% percentage = current_user.mapping_percentage(course.id) %>
            <div class="progress">
              <div class="progress-bar progress-bar-striped progress-bar-animated length" role="progressbar" aria-valuenow="<%= percentage %>%" aria-valuemin="0" aria-valuemax="100" style="width: <%= percentage %>%"></div>
            </div>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <div class="courses-container">
    <h1 class="highlight">Discover other courses</h1>
    <div class="flags">
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="category" id="search_query">
              <%= link_to 'ðŸ‡¬ðŸ‡§', courses_path(language: "english")  %>
            </button>
          </div>
        </div>
      </div>
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="sq_category" id="search_query">
              <%= link_to 'ðŸ‡³ðŸ‡±', courses_path(language: "dutch")  %>
            </button>
          </div>
        </div>
      </div>
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="sq_category" id="search_query">
              <%= link_to 'ðŸ‡«ðŸ‡·', courses_path(language: "french")  %>
            </button>
          </div>
        </div>
      </div>
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="sq_category" id="search_query">
              <%= link_to 'ðŸ‡®ðŸ‡¹', courses_path(language: "italian")  %>
            </button>
          </div>
        </div>
      </div>
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="sq_category" id="search_query">
              <%= link_to 'ðŸ‡ªðŸ‡¸', courses_path(language: "spanish")  %>
            </button>
          </div>
        </div>
      </div>
      <div class="flag">
        <div class="searchbar">
          <div class="search-form-control form-group">
            <button class='button-flag' name="sq_category" id="search_query">
              <%= link_to 'All', courses_path(language: "")  %>
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="course-container">
      <% @courses.each do |course| %>
      <div class="popup">
        <div class="card-trip"
          data-toggle="popover"
          data-placement="right"
          title="<b><%= course.name.capitalize %></b>"
          data-content='â‚¬9.99
                        <br>
                        <% if policy(Course).create? %>
                        <%= link_to "Join course", course_subscriptions_path(course), method: :post %>
                        <% end %>' >
                        <!-- above we pass the course in the url string properly -->
          <img src="https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/greece.jpg">
          <div class="card-trip-infos">
            <h2><%= course.name.capitalize %></h2>
            <!-- passing the course id as aquery parameter in the url -->
            <%= link_to "Join course", subscription_path(course: course), method: :post %>
          </div>
        </div>
      </div>
      <% end %>
    </div>
      </div>
    </div>
  </div>
</div>

  </div>
</div>

